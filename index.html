<!DOCTYPE html>
<html>
<link rel="stylesheet" href="index.css">

<head>
    <base target="_top">
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>매드러너 점메추</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link href="https://unpkg.com/aos@2.3.1/dist/aos.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css?family=Noto+Sans+KR:400,500,700,900&display=swap&subset=korean" rel="stylesheet">
</head>


<body>

    <!-- 상단 NAV -->

    <header>
        <div class="navbar" style="box-sizing: border-box; width: 100%; height: 80px; padding: 10px;">
            <img src="img/logo.svg" style="height: 50px">
        </div>
    </header>


        <div class="x290">

            <div class="main_copy" style="box-sizing: border-box; line-height: 130%; width: 100%; padding: 40px 0 0 15px">
                <h1>잘 뛰려면</h1>
                <h1>잘 먹어야하니까</h1>
                <p style="color: #838383; margin: 30px 0;">
                    오늘 뭐먹지? 하고 고민될 때<br>
                    사용해주세요
                </p>
            </div>

            <div class="division" style="margin: 3rem auto; padding: 8px">
                <hr style="width: 80px; height: 2px; text-align: center; background-color: black;">
            </div>

            <!-- 랜덤 노출 -->

            <div id="random-store" style="box-sizing: border-box; line-height: 120%; width: 100%; padding:0 15px 0 15px">

                <h2>오늘은</h2>
                <h2 class="restaurant" style="color: #4a60a8;"></h2>
                <h2>어떠세요?</h2>

                <div class="info" style="margin: 15px 0">
                    <p class="menu"></p>
                    <p class="address"></p>
                    <p class="cost"></p>
                </div>

                <button id="map-api" type="button" style="display: inline-block;">
                    
                    <img src="img/place.svg" style="height:20px; display:inline-block;  vertical-align: middle;" />
                    <p style="display:inline-block; margin: 0; vertical-align: middle;">네이버 지도에서 보기</p>
                
                </button>

            </div>

            <!-- 추천 코드 -->

            <script>
                async function fetchRandomStore() {
                    const url = 'https://script.google.com/macros/s/AKfycbxvZ8YNH7_edmT0XWiRlvKEJ-4d8rZHct9XcGIrIUpTPMGv6JXB2ChMnxNdzBIlWpvl/exec'; // 생성된 Apps Script URL로 변경
                    try {
                        const response = await fetch(url);
                        const data = await response.json();
                        displayStore(data);
                    } catch (error) {
                        console.error("데이터를 가져오는 중 오류 발생:", error);
                    }
                }
        
                function displayStore(data) {
                    document.querySelector(".restaurant").textContent = data.storeName;
                    document.querySelector(".menu").textContent = data.menuName;
                    document.querySelector(".address").textContent = data.address;
                    document.querySelector(".cost").textContent = data.priceRange;
                    
                    // 현재 주소 저장
                    currentStoreName = data.storeName;
                }
        

                document.getElementById("map-api").addEventListener("click", () => {
                    if (currentStoreName) {
                        const naverMapUrl = `https://map.naver.com/v5/search/${encodeURIComponent(currentStoreName)}`;
                        window.open(naverMapUrl, "_blank"); // 새 탭으로 열기
                    } else {
                        alert("가게 이름을 불러오는 중입니다. 잠시 후 다시 시도해 주세요.");
                    }
                });

                // 페이지 로드 시 함수 호출
                fetchRandomStore();
            </script>


            <!-- 하단 버튼들 -->

            <div class="reload" style="display:flex; margin: 4rem auto 1rem auto">
                <button type="button" onClick="window.location.reload()">새로고침</button>
            </div>

        

            <div class="add-restaurant" style="display:flex; margin: 1rem auto 2rem auto">
                <button type="button" id="btn-modal">식당 등록하기</button>
            </div>

            <!-- 식당 추가 팝업창-->
            <div id="modal" class="modal-overlay">
                <div class="modal-window">
                    <div class="close-area"> × </div>

                    <div class="title">
                        <h2></h2><br>
                        <h2>새로운 식당을 등록해주세요</h2><br>
                        <p>여러분의 제보가 풍족한 점심시간을 만듭니다.</p><br>
                    </div>

                    <div class="content">
                        <div class="restaurantName">
                            <p>식당 이름</p>
                            <input type="text" placeholder="ex. 쿠차라">
                        </div>
                        <div class="restaurantMenu">
                            <p>주요 메뉴</p>
                            <input type="text" placeholder="ex. 부리또볼">
                        </div>
                        <div class="restaurantName">
                            <p>가격대</p>
                            <input type="text" placeholder="ex. 12000원~18000원">
                        </div>
                    </div>

                    <div class="submit">
                        <button type="button">등록하기</button>
                    </div>
                </div>
            </div>
            

        </div>

    </div>


    <!-- form function -->

    <script> 

        const modal = document.getElementById("modal")
        const btnModal = document.getElementById("btn-modal")
        const bodya = document.body

        function modalOn() {
            modal.style.display = "flex"
            bodya.style.overflow = "hidden"
        }


        function modalOff() {
            modal.style.display = "none"
            bodya.style.overflow = "scroll"
        }

        btnModal.addEventListener("click", e => {
            modalOn()
        })

        const closeBtn = modal.querySelector(".close-area")

        console.log(closeBtn)

        closeBtn.addEventListener("click", e => {
            modalOff()
        })

        modal.addEventListener("click", e => {
            const evTarget = e.target
            if(evTarget.classList.contains("modal-overlay")) {
                modalOff()
            }
        })
    </script>


    <footer>
        <p style="font-size: 12px">문의 : jhhyun@madup.com</p>
    </footer>

</body>

</html>